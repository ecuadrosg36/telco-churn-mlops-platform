# Telco Churn MLOps Platform - Configuration
# Base configuration file for all environments

project:
  name: telco-churn-mlops
  version: "1.0.0"
  description: "Production MLOps platform for customer churn prediction"

# Data configuration
data:
  raw_dir: "data/raw"
  processed_dir: "data/processed"
  gold_dir: "data/gold"
  predictions_dir: "data/predictions"
  
  # Kaggle dataset
  kaggle_dataset: "blastchar/telco-customer-churn"
  kaggle_file: "WA_Fn-UseC_-Telco-Customer-Churn.csv"
  
  # Train/val/test split ratios
  train_ratio: 0.70
  val_ratio: 0.15
  test_ratio: 0.15
  random_seed: 42

# Feature engineering
features:
  target: "Churn"
  
  categorical_features:
    - gender
    - SeniorCitizen
    - Partner
    - Dependents
    - PhoneService
    - MultipleLines
    - InternetService
    - OnlineSecurity
    - OnlineBackup
    - DeviceProtection
    - TechSupport
    - StreamingTV
    - StreamingMovies
    - Contract
    - PaperlessBilling
    - PaymentMethod
  
  numerical_features:
    - tenure
    - MonthlyCharges
    - TotalCharges
  
  # Derived features to create
  engineered_features:
    - tenure_bins
    - charges_ratio
    - service_count
    - is_long_term_customer

# Model configuration
model:
  # Start with RandomForest as baseline
  baseline:
    type: "RandomForest"
    n_estimators: 100
    max_depth: 10
    min_samples_split: 5
    random_state: 42
    n_jobs: -1
  
  # Advanced model - XGBoost
  advanced:
    type: "XGBoost"
    n_estimators: 200
    max_depth: 6
    learning_rate: 0.1
    subsample: 0.8
    colsample_bytree: 0.8
    random_state: 42
    n_jobs: -1
  
  # Model selection thresholds
  metrics:
    primary_metric: "f1_score"
    min_accuracy: 0.75
    min_f1: 0.70
    min_auc: 0.75

# MLflow configuration
mlflow:
  tracking_uri: "./mlruns"
  experiment_name: "telco-churn-prediction"
  model_registry_name: "telco-churn-model"
  
  # Model registry stages
  stages:
    development: "None"
    staging: "Staging"
    production: "Production"
    archived: "Archived"
  
  # Autolog settings
  autolog: true
  log_models: true

# Monitoring configuration
monitoring:
  reports_dir: "monitoring/reports"
  reference_data_path: "data/reference/churn_reference.csv"
  
  # Drift detection thresholds
  drift_thresholds:
    dataset_drift_share: 0.3  # 30% of features drifted
    stattest_threshold: 0.05   # p-value threshold
  
  # Report generation
  reports:
    - data_drift
    - data_quality
    - target_drift

# API configuration
api:
  host: "0.0.0.0"
  port: 8080
  workers: 4
  reload: false
  log_level: "info"
  
  # Model loading
  model_source: "mlflow_registry"  # mlflow_registry or local_path
  model_stage: "Production"
  fallback_to_latest: true
  
  # Request limits
  max_batch_size: 1000
  request_timeout: 30

# Logging configuration
logging:
  level: "INFO"
  format: "json"
  
  handlers:
    console: true
    file: true
    
  file_config:
    path: "logs/app.log"
    max_bytes: 10485760  # 10MB
    backup_count: 5

# Environment-specific overrides loaded from config_dev.yaml or config_prod.yaml
